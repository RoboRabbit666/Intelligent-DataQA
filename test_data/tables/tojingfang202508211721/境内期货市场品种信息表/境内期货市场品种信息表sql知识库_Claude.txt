问题：2025年7月广州期货交易所所有品种的总成交额是多少？
SELECT SUM(trd_amt) AS 总成交额
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'GFE' 
AND BIZ_DT BETWEEN '2025-07-01' AND '2025-07-31';

问题：查找2025年6月份主力合约持仓量超过10000手的期货品种？
SELECT CLAS_NAME, AVG(main_comd_hld_qty) AS 平均主力合约持仓量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-06-01' AND '2025-06-30'
AND fut_opt_flag = 'F'
GROUP BY CLAS_NAME
HAVING AVG(main_comd_hld_qty) > 10000
ORDER BY 平均主力合约持仓量 DESC;

问题：上海国际能源交易中心2025年8月份期权品种的成交量统计？
SELECT CLAS_NAME, SUM(trd_qty) AS 总成交量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'INE'
AND BIZ_DT BETWEEN '2025-08-01' AND '2025-08-31'
AND fut_opt_flag = 'O'
GROUP BY CLAS_NAME
ORDER BY 总成交量 DESC;

问题：2025年第一季度近月合约成交额占比最高的交易所是哪个？
SELECT EXCH_NAME, 
       SUM(near_mon_comd_trd_amt) AS 近月合约总成交额,
       SUM(trd_amt) AS 总成交额,
       ROUND((SUM(near_mon_comd_trd_amt) / SUM(trd_amt)) * 100, 2) AS 近月合约成交额占比
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-01-01' AND '2025-03-31'
GROUP BY EXCH_NAME
ORDER BY 近月合约成交额占比 DESC
LIMIT 1;

问题：查找2025年7月份主力合约和近月合约为同一个合约的品种？
SELECT DISTINCT CLAS_NAME, main_comd, near_mon_comd
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-07-01' AND '2025-07-31'
AND main_comd = near_mon_comd
AND main_comd IS NOT NULL
AND near_mon_comd IS NOT NULL;

问题：郑州商品交易所白糖期货2025年上半年的月均成交量？
SELECT EXTRACT(MONTH FROM BIZ_DT) AS 月份,
       AVG(trd_qty) AS 月均成交量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'CZCE'
AND CLAS_ABBR = '白糖'
AND fut_opt_flag = 'F'
AND BIZ_DT BETWEEN '2025-01-01' AND '2025-06-30'
GROUP BY EXTRACT(MONTH FROM BIZ_DT)
ORDER BY 月份;

问题：2025年5月份哪个品种的主力合约结算价波动最大？
SELECT CLAS_NAME,
       MAX(main_comd_clr_prc) AS 最高结算价,
       MIN(main_comd_clr_prc) AS 最低结算价,
       MAX(main_comd_clr_prc) - MIN(main_comd_clr_prc) AS 价格波动幅度
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-05-01' AND '2025-05-31'
AND main_comd_clr_prc IS NOT NULL
GROUP BY CLAS_NAME
ORDER BY 价格波动幅度 DESC
LIMIT 1;

问题：查找2025年6月大连商品交易所期货品种中持仓量增长最快的品种？
WITH daily_position AS (
    SELECT BIZ_DT, CLAS_NAME, hld_qty,
           LAG(hld_qty) OVER (PARTITION BY CLAS_NAME ORDER BY BIZ_DT) AS prev_hld_qty
    FROM dataqa.fut_mrkt_clas_info_tab
    WHERE EXCH_CODE = 'DCE'
    AND fut_opt_flag = 'F'
    AND BIZ_DT BETWEEN '2025-06-01' AND '2025-06-30'
)
SELECT CLAS_NAME,
       SUM(hld_qty - prev_hld_qty) AS 总持仓量变化
FROM daily_position
WHERE prev_hld_qty IS NOT NULL
GROUP BY CLAS_NAME
ORDER BY 总持仓量变化 DESC
LIMIT 1;

问题：2025年第二季度各交易所期权品种数量统计？
SELECT EXCH_NAME, COUNT(DISTINCT CLAS_NAME) AS 期权品种数量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-04-01' AND '2025-06-30'
AND fut_opt_flag = 'O'
GROUP BY EXCH_NAME
ORDER BY 期权品种数量 DESC;

问题：查找2025年7月份所有交易所中成交额最高的单个品种？
SELECT EXCH_NAME, CLAS_NAME, SUM(trd_amt) AS 总成交额
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-07-01' AND '2025-07-31'
GROUP BY EXCH_NAME, CLAS_NAME
ORDER BY 总成交额 DESC
LIMIT 1;

问题：上海期货交易所2025年6月黄金期货的日均主力合约成交量？
SELECT AVG(main_comd_trd_qty) AS 日均主力合约成交量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'SHFE'
AND CLAS_ABBR = '黄金'
AND fut_opt_flag = 'F'
AND BIZ_DT BETWEEN '2025-06-01' AND '2025-06-30';

问题：2025年8月份近月合约持仓量为0的品种有哪些？
SELECT DISTINCT CLAS_NAME, EXCH_NAME
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-08-01' AND '2025-08-31'
AND near_mon_comd_hld_qty = 0
ORDER BY EXCH_NAME, CLAS_NAME;

问题：中国金融期货交易所2025年上半年各品种主力合约平均结算价？
SELECT CLAS_NAME, ROUND(AVG(main_comd_clr_prc), 2) AS 平均主力合约结算价
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'CFFEX'
AND BIZ_DT BETWEEN '2025-01-01' AND '2025-06-30'
AND main_comd_clr_prc IS NOT NULL
GROUP BY CLAS_NAME
ORDER BY 平均主力合约结算价 DESC;

问题：2025年7月份哪个交易日全市场期货总成交量最高？
SELECT BIZ_DT, SUM(trd_qty) AS 全市场期货总成交量
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-07-01' AND '2025-07-31'
AND fut_opt_flag = 'F'
GROUP BY BIZ_DT
ORDER BY 全市场期货总成交量 DESC
LIMIT 1;

问题：查找2025年5月份主力合约成交额超过品种总成交额80%的品种？
SELECT CLAS_NAME, EXCH_NAME,
       SUM(main_comd_trd_amt) AS 主力合约总成交额,
       SUM(trd_amt) AS 品种总成交额,
       ROUND((SUM(main_comd_trd_amt) / SUM(trd_amt)) * 100, 2) AS 主力合约成交额占比
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-05-01' AND '2025-05-31'
GROUP BY CLAS_NAME, EXCH_NAME
HAVING (SUM(main_comd_trd_amt) / SUM(trd_amt)) > 0.8
ORDER BY 主力合约成交额占比 DESC;

问题：2025年第一季度各品种期权与期货成交量比较？
SELECT CLAS_NAME,
       SUM(CASE WHEN fut_opt_flag = 'F' THEN trd_qty ELSE 0 END) AS 期货成交量,
       SUM(CASE WHEN fut_opt_flag = 'O' THEN trd_qty ELSE 0 END) AS 期权成交量,
       CASE 
         WHEN SUM(CASE WHEN fut_opt_flag = 'F' THEN trd_qty ELSE 0 END) > 0 
         THEN ROUND(SUM(CASE WHEN fut_opt_flag = 'O' THEN trd_qty ELSE 0 END) / 
                    SUM(CASE WHEN fut_opt_flag = 'F' THEN trd_qty ELSE 0 END), 4)
         ELSE NULL 
       END AS 期权期货成交量比率
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-01-01' AND '2025-03-31'
GROUP BY CLAS_NAME
HAVING SUM(CASE WHEN fut_opt_flag = 'O' THEN trd_qty ELSE 0 END) > 0
ORDER BY 期权期货成交量比率 DESC;

问题：上海期货交易所2025年6月份铜期货的最大单日成交额？
SELECT BIZ_DT, trd_amt AS 单日成交额
FROM dataqa.fut_mrkt_clas_info_tab
WHERE EXCH_CODE = 'SHFE'
AND CLAS_CODE = 'CU'
AND fut_opt_flag = 'F'
AND BIZ_DT BETWEEN '2025-06-01' AND '2025-06-30'
ORDER BY trd_amt DESC
LIMIT 1;

问题：2025年7月份各品种近月合约与主力合约持仓量差异分析？
SELECT CLAS_NAME, EXCH_NAME,
       AVG(main_comd_hld_qty) AS 平均主力合约持仓量,
       AVG(near_mon_comd_hld_qty) AS 平均近月合约持仓量,
       AVG(main_comd_hld_qty - near_mon_comd_hld_qty) AS 平均持仓量差异
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-07-01' AND '2025-07-31'
AND main_comd_hld_qty IS NOT NULL
AND near_mon_comd_hld_qty IS NOT NULL
GROUP BY CLAS_NAME, EXCH_NAME
ORDER BY 平均持仓量差异 DESC;

问题：查找2025年第二季度交易活跃度最高的期权品种？
SELECT CLAS_NAME, EXCH_NAME,
       COUNT(DISTINCT BIZ_DT) AS 交易天数,
       AVG(trd_qty) AS 平均日成交量,
       AVG(hld_qty) AS 平均持仓量,
       AVG(trd_qty) * COUNT(DISTINCT BIZ_DT) AS 活跃度指标
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-04-01' AND '2025-06-30'
AND fut_opt_flag = 'O'
AND trd_qty > 0
GROUP BY CLAS_NAME, EXCH_NAME
ORDER BY 活跃度指标 DESC
LIMIT 5;

问题：2025年上半年各交易所期货品种的平均换手率排名？
SELECT EXCH_NAME, CLAS_NAME,
       AVG(CASE WHEN hld_qty > 0 THEN trd_qty / hld_qty ELSE 0 END) AS 平均换手率
FROM dataqa.fut_mrkt_clas_info_tab
WHERE BIZ_DT BETWEEN '2025-01-01' AND '2025-06-30'
AND fut_opt_flag = 'F'
AND hld_qty > 0
GROUP BY EXCH_NAME, CLAS_NAME
ORDER BY 平均换手率 DESC
LIMIT 10;